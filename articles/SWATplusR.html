<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with SWATplusR • SWATplusR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with SWATplusR">
<meta property="og:description" content="SWATplusR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATplusR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SWATplusR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/par_sampl_calib.html">Parameter sampling and model calibration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chrisschuerz/SWATplusR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with SWATplusR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chrisschuerz/SWATplusR/blob/HEAD/vignettes/SWATplusR.Rmd" class="external-link"><code>vignettes/SWATplusR.Rmd</code></a></small>
      <div class="hidden name"><code>SWATplusR.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="loading-swatplusr">Loading <code>SWATplusR</code><a class="anchor" aria-label="anchor" href="#loading-swatplusr"></a>
</h2>
<p>If you did not install <code>SWATplusR</code> yet you can do that now running the following lines in <code>R</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If the package remotes is not installed run first:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'remotes'</span><span class="op">)</span>

<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'chrisschuerz/SWATplusR'</span><span class="op">)</span></code></pre></div>
<p>Before we start exploring the package load <code>SWATplusR</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chrisschuerz/SWATplusR" class="external-link">SWATplusR</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="swat-demo-projects">SWAT demo projects<a class="anchor" aria-label="anchor" href="#swat-demo-projects"></a>
</h2>
<p><code>SWATdata</code> provides a set of fast running, lightweight SWAT2012 and SWAT+ model setups of a head watershed of the Little River Experimental Watershed [LREW; <span class="citation"><a href="#ref-Bosch2007" role="doc-biblioref">Bosch et al.</a> (<a href="#ref-Bosch2007" role="doc-biblioref">2007</a>)</span>]. Additionally, discharge observations at the outlet of the demo catchment (gauge J of LREW) and spatial information of the SWAT model setups are available from <code>SWATdata</code>. The <a href="https://github.com/chrisschuerz/SWATdata#swatdata-" class="external-link"><code>SWATdata</code></a> GitHub page gives an overview of the available data sets.</p>
<div class="section level3">
<h3 id="loading-a-swat-project">Loading a SWAT project<a class="anchor" aria-label="anchor" href="#loading-a-swat-project"></a>
</h3>
<p>Demo data can be loaded with the function <code><a href="../reference/load_demo.html">load_demo()</a></code>. With the input argument <code>dataset</code> you can define which SWAT project data you want to load. To load a SWAT project folder define <code>dataset = 'project'</code>. The <code>path</code> defines the path on your local hard drive where you want to store the SWAT project folder. <strong><em>Caution:</em></strong> *Please try to avoid blanks in your path names (e.g. ‘C:/this is a/path with blanks’). This can cause issues when running the model. Try to use e.g. ’_’ in your path names instead.* As the SWAT project is available as SWAT+ and as SWAT2012 project you have to specify the <code>version</code> of the SWAT project you want to load. Use <code>version = 'plus'</code> to load a SWAT+ project and <code>version = '2012'</code> to load a SWAT2012 version of the project. SWAT+ is under constant development and new model revisions are released from time to time. I try to keep <code>SWATdata</code> and the SWAT+ demo projects up to date and provide at least a few of the last SWAT+ revisions as demo projects. If no <code>revision</code> number is specified the most recent SWAT+ model is loaded. You can, however, also load a SWAT+ project with that was built for a specific SWAT+ revision by providing for example the input argument <code>revision = 59.3</code> to load a SWAT+ revision 59.3 model setup. Please check the <a href="https://github.com/chrisschuerz/SWATdata#swatdata-" class="external-link"><code>SWATdata</code></a> GitHub page to see which model setups are available. The two examples below load the most recent SWAT+ model setup and the available SWAT2012 setup.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The path where the SWAT demo project will be written</span>
<span class="va">demo_path</span> <span class="op">&lt;-</span> <span class="st">'Define:/your/path'</span>

<span class="co"># Loading a SWAT+ demo project</span>
<span class="va">path_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_demo.html">load_demo</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">'project'</span>,
                       path <span class="op">=</span> <span class="va">demo_path</span>,
                       version <span class="op">=</span> <span class="st">'plus'</span><span class="op">)</span>

<span class="co"># Loading a SWAT2012 demo project</span>
<span class="va">path_2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_demo.html">load_demo</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">'project'</span>,
                       path <span class="op">=</span> <span class="va">demo_path</span>,
                       version <span class="op">=</span> <span class="st">'2012'</span><span class="op">)</span></code></pre></div>
<p>In the case of a SWAT project <code><a href="../reference/load_demo.html">load_demo()</a></code> saves the defined SWAT project in the file path that was defined with <code>path = demo_path</code> and returns the final demo project path as a character string in <code>R</code>. I assigned these paths to the variables <code>path_plus</code> and <code>path_2012</code> to use them later in the model runs.</p>
</div>
<div class="section level3">
<h3 id="observation-data">Observation data<a class="anchor" aria-label="anchor" href="#observation-data"></a>
</h3>
<p><code>SWATdata</code> also provides daily discharge records for the outlet of the demo catchment (Gauge J of LREW) for the time period 1968-01-01 until 2012-12-31. Observation data are useful for the model evaluation. These date will be used in several examples with the SWAT demo projects. You can load the observation data again using the function <code><a href="../reference/load_demo.html">load_demo()</a></code>. To access the observation data set you have to define <code>dataset = 'observation'</code>. The other input arguments are not required in this case as the observation data are the same for all demos. When loading the observation data set <code><a href="../reference/load_demo.html">load_demo()</a></code> returns a data frame with a date column and a column for the mean daily discharge at that date. In the code below the observation data frame is assigned to the variable <code>q_obs</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_demo.html">load_demo</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">'observation'</span><span class="op">)</span>

<span class="va">q_obs</span></code></pre></div>
<pre><code><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16,437 x 2</span></span>
<span class="co">#&gt;    date       discharge</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1968-01-01      0.16</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1968-01-02      0.57</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1968-01-03      0.61</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1968-01-04      0.37</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1968-01-05      0.25</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1968-01-06      0.2 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1968-01-07      0.21</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1968-01-08      0.22</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1968-01-09      0.18</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1968-01-10      0.34</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 16,427 more rows</span></span></code></pre>
<p>A quick plot of the observation data <code>q_obs</code> shows the daily mean discharge at Gauge J for the years 1968 to 2012 in <span class="math inline">\(m^3 s^{-1}\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q_obs</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span></code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="first-swat-model-runs">First SWAT model runs<a class="anchor" aria-label="anchor" href="#first-swat-model-runs"></a>
</h2>
<p>With the functions <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> you can perform simulations in a SWAT+ or a SWAT2012 project folder that is located on the local hard drive. SWAT model simulations write a large range of output variables after a simulation run. Usually only a few variables are analyzed (e.g. in-stream discharge or nutrient loads). With the function <code><a href="../reference/define_output.html">define_output()</a></code> you can specify the output variables that are returned to <code>R</code> after the simulation run. Thus, the minimum information you have to provide to perform a model simulation is where your project is located with the input argument <code>project_path</code> and which simulation outputs should be returned after the simulation defined with the input argument <code>output</code>. The output variables are always specified with the function <code><a href="../reference/define_output.html">define_output()</a></code> and passed through with the input argument <code>output</code>. The example below shows a minimum example for a SWAT+ project.</p>
<div class="section level3">
<h3 id="project_path">
<code>project_path</code><a class="anchor" aria-label="anchor" href="#project_path"></a>
</h3>
<p>As the project path we define the path to the previously loaded demo project <code>project_path = path_plus</code>. If you do not want to work with the demo project, but you already want to use your own SWAT project you can define the path to your SWAT ‘TxtInOut’ folder and simply run simulations there. Be aware in this case that the runtime can be much longer for large projects, which might hinder you in testing many things when first playing around with <code>SWATplusR</code>. The demo projects are designed in a way that simulations should not take longer than a few seconds, depending on the machine where it is executed. If you want to use your own SWAT project please consider a few things:</p>
<ul>
<li>The SWAT project folder must contain exactly one executable file. <code>run_swat*()</code> automatically searches for the one SWAT executable in the project folder. If there are no or more than one executables available in the project folder an error is returned as <code>run_swat*()</code> does not know which executable file to use.</li>
<li>Weather data must be provided with the project as <code>run_swat*()</code> does some checks for which time periods weather data are available.</li>
<li>Make clear to use the right function, ether <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> to run a SWAT+ project, or <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> to run a SWAT2012 project.</li>
<li>again <strong><em>Caution:</em></strong> *Please try to avoid blanks in your path names (e.g. ‘C:/this is a/path with blanks’). This can cause issues when running the model. Try to use e.g. ’_’ in your path names instead.*</li>
</ul>
</div>
<div class="section level3">
<h3 id="output-and-define_output">
<code>output</code> and <code>define_output()</code><a class="anchor" aria-label="anchor" href="#output-and-define_output"></a>
</h3>
<p>The simple example below defines only one output that is returned to <code>R</code>. The definition follows a simple syntax. <code><a href="../reference/define_output.html">define_output()</a></code> requires three input arguments. The <code>file</code> indicates in which file the SWAT output variable of interest is written. As we want to return the discharge in this example we define <code>file = 'channel_sd'</code>. All output files for SWAT+ are listed in the <em>‘print.prt’</em> of your SWAT+ project. The variable for the discharge that leaves a channel is called <code>'flo_out'</code>. We define <code>variable = 'flo_out'</code>. The third input argument is <code>unit</code>. <code>unit</code> defines for which units, in this case for which channels, we want to extract the output <code>variable</code>. The SWAT+ demo project has only one channel and therefore we define <code>unit = 1</code>. The correct channel ID is listed in the <em>‘chandeg.con’</em> file in the SWAT+ project folder. If you have, many channels and you want to compare your simulation outputs with observation data, make sure to select the correct <code>id</code> that corresponds to your gauge location.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                           output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'channel_sd'</span>,
                                                  variable <span class="op">=</span> <span class="st">'flo_out'</span>,
                                                  unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 0S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 0S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 3S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 3S</span></code></pre></div>
<p>The syntax of <code><a href="../reference/define_output.html">define_output()</a></code> that was shown above for SWAT+ is the same for SWAT2012 projects. The only difference between the two models in the output definition is how to correctly address the output variables. The output files are organized differently in SWAT+ and SWAT2012. SWAT2012 simulations generate output files that are called <em>‘output.’</em> followed by a suffix that defines the type of output. Subbasin outputs are stored in the <em>‘.sub’</em> file, HRU outputs in the <em>‘.hru’</em> file, and channel outputs for example in the ’<em>.rch’</em> file. This list is not comprehensive and there are further output files. If you want to return variables from other SWAT2012 output files please please go through the <em>‘output.’</em> files in your project folder after performing a simulation run. In the minimum example we define <code>file = 'rch'</code> to access the channel output file. The variable <em>‘FLOW_OUT’</em> defines the discharge that leaves a channel. Therefore, we define <code>variable = 'FLOW_OUT'</code>. <strong><em>Caution:</em></strong> <em>Be aware that the variable definition is case sensitive and variables in SWAT2012 are usually upper case.</em> The SWAT2012 demo project has in total 3 channels. In the output definition we can also define multiple units for which we want to extract outputs. In the example below we define <code>unit = 1:3</code> which means that we return the <em>‘FLOW_OUT’</em> for the channel units 1,2, and 3.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swat2012.html">run_swat2012</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_2012</span>,
                           output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'rch'</span>,
                                                  variable <span class="op">=</span> <span class="st">'FLOW_OUT'</span>,
                                                  unit <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swat2012_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 3S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 3S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 4S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 4S</span></code></pre></div>
<p>All caps variable names can be annoying when you frequently call them in your analyses in <code>R</code>. You can also assign a different name to the ouput variables. The only difference is that you have to provide the defined outputs in a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>. The output definition in a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> is required in any case when you want to define several output variables, which is further explained in the article on output definition. The small example below performs exactly the same SWAT2012 simulations as above but assigns the names <code>q_1</code>, <code>q_2</code>, and <code>q_3</code> to the output variables.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_2012_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swat2012.html">run_swat2012</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_2012</span>,
                             output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'rch'</span>,
                                                             variable <span class="op">=</span> <span class="st">'FLOW_OUT'</span>,
                                                             unit <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
 
<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swat2012_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 3S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 3S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 4S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 4S</span></code></pre></div>
<p>The two examples for our first SWAT simulations use very basic output definitions. The <code>output</code> definition in <code>run_swat*()</code> can be more complex and more comprehensive. A more detailed insight with further examples is provided in an article that focuses on simulation output definition. I recommend to go the examples in this article as well, as your model simulations should very likely return more than just the discharge at your catchment outlet <em>(The article is currently in preparation and will be online soon. Please be patient in the meantime)</em>.</p>
</div>
<div class="section level3">
<h3 id="exploring-the-simulation-outputs">Exploring the simulation outputs<a class="anchor" aria-label="anchor" href="#exploring-the-simulation-outputs"></a>
</h3>
<p><code>SWATplusR</code> aims to return SWAT simulations in a <em>tidy</em> format. The date structure of the simulation results is different for single simulation and many simulations with different parameter sets. Yet, the general structure is the same for all simulation outputs returned in <code>R</code>. Simulation results are always arranged in <code>tibbles</code> <span class="citation">(<a href="#ref-Mueller2019" role="doc-biblioref">Müller and Wickham, 2019</a>)</span>. In the <code>run_swat*()</code> default setting (<code>add_date = TRUE</code>) the first column of the simulation results is always the date column followed by the columns for the output variables. If a single simulation run was performed without parameter changes (<code>parameter = NULL</code> so the default setting) a single tibble with the simulation outputs for that run is returned. When performing simulations with one or many different parameter sets a list of tibbles is returned that I explain <a href="https://chrisschuerz.github.io/SWATplusR/articles/SWATplusR.html#exploring-simulations-with-parameter-changes" class="external-link">below</a>.</p>
<p>If we have a look at the outputs of all three simulations we see that they all have the same general structure. The first column is a date column which is followed by the defined output variables. In the case of the SWAT+ simulation outputs <code>q_sim_plus</code> the single output variable that we defined is called <code>flo_out</code>, so the name of the variable as it is defined in the <em>.txt</em> output file.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_plus</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 2</span></span>
<span class="co">#&gt;    date       flo_out</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.004<span style="text-decoration: underline;">12</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span></code></pre></div>
<p>For the SWAT2012 model setup we defined to return the discharges of all three channels in the model setup. In the simulation outputs we can see now that a suffix number was added to the variable names. These numbers correspond to the unit IDs in the output table. Thus, you can directly relate the outputs in <code>R</code> to the respective units in a model setup.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_2012</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 4</span></span>
<span class="co">#&gt;    date       FLOW_OUT_1 FLOW_OUT_2 FLOW_OUT_3</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01      0.174     0.103       0.413</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02      0.154     0.095<span style="text-decoration: underline;">6</span>      0.377</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03      0.150     0.093<span style="text-decoration: underline;">5</span>      0.369</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04      0.148     0.092<span style="text-decoration: underline;">1</span>      0.363</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05      0.146     0.091<span style="text-decoration: underline;">2</span>      0.359</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06      0.145     0.090<span style="text-decoration: underline;">6</span>      0.357</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07      0.144     0.090<span style="text-decoration: underline;">1</span>      0.355</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08      0.144     0.089<span style="text-decoration: underline;">7</span>      0.354</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09      0.143     0.089<span style="text-decoration: underline;">4</span>      0.353</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10      0.143     0.089<span style="text-decoration: underline;">0</span>      0.352</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span></code></pre></div>
<p>As mentioned above, the only difference between <code>q_sim_2012</code> and <code>q_sim_2012_2</code> is the naming of the output variables. We defined that the should now be called <code>q</code> instead of <code>FLOW_OUT</code>. Although the name has changed the suffix values are the same in this case and is added automatically by <code><a href="../reference/define_output.html">define_output()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim_2012_2</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 4</span></span>
<span class="co">#&gt;    date         q_1    q_2   q_3</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.174 0.103  0.413</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0.154 0.095<span style="text-decoration: underline;">6</span> 0.377</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0.150 0.093<span style="text-decoration: underline;">5</span> 0.369</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0.148 0.092<span style="text-decoration: underline;">1</span> 0.363</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0.146 0.091<span style="text-decoration: underline;">2</span> 0.359</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0.145 0.090<span style="text-decoration: underline;">6</span> 0.357</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0.144 0.090<span style="text-decoration: underline;">1</span> 0.355</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0.144 0.089<span style="text-decoration: underline;">7</span> 0.354</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0.143 0.089<span style="text-decoration: underline;">4</span> 0.353</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0.143 0.089<span style="text-decoration: underline;">0</span> 0.352</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span></code></pre></div>
<p>You can see from all three simulation outputs that daily simulation outputs were returned and the output printing in all cases started with the date 2003-01-01. The simple reason for that is that the default settings in the <em>‘file.cio’</em> of the SWAT2012 model setup and the <em>‘print.prt’</em> and <em>‘time.sim’</em> files of the SWAT+ model setup are defined to perform simulations between 2000-01-01 and 2012-12-31 and to skip 3 years and return daily outputs. In practice we often want to change all of these model parameters. <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> do have many input arguments to specify these and other model configurations. I will explain further input arguments in the section <a href="https://chrisschuerz.github.io/SWATplusR/articles/SWATplusR.html#further-swatplusr-input-arguments" class="external-link">Further input arguments</a>.</p>
</div>
<div class="section level3">
<h3 id="plotting-the-simulation-outputs">Plotting the simulation outputs<a class="anchor" aria-label="anchor" href="#plotting-the-simulation-outputs"></a>
</h3>
<p>The clear data strucure of SWAT simulations that are returned with <code>run_swat*()</code> facilitate their integration into any analyses, without any major data preparation necessary. The small example below shows how we can use the simulation outputs to plot the SWAT+ simulations and the SWAT2012 simulations together with the observed discharge.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Loading R package for data analysis (dplyr and tidyr) and plotting (ggplot2)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'tidyr' was built under R version 4.1.2</span>
<span class="co"># Prepare the SWAT+ simulation output</span>
<span class="va">q_plus</span> <span class="op">&lt;-</span> <span class="va">q_sim_plus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>q_plus <span class="op">=</span> <span class="va">flo_out</span><span class="op">)</span> <span class="co"># Rename the output to q_plus</span>

<span class="co"># Prepare the SWAT2012 simulation output</span>
<span class="va">q_2012</span> <span class="op">&lt;-</span> <span class="va">q_sim_2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">FLOW_OUT_3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Only select the columns date and FLOW_OUT_3</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>q_2012 <span class="op">=</span> <span class="va">FLOW_OUT_3</span><span class="op">)</span>  <span class="co"># Rename the output to q_plus</span>

<span class="co"># Prepare the table for plotting</span>
<span class="va">q_plot</span> <span class="op">&lt;-</span> <span class="va">q_obs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>q_obs <span class="op">=</span> <span class="va">discharge</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Rename the discharge columnt to q_obs</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2003</span><span class="op">:</span><span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Filter for years between 2003 and 2012</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">q_plus</span>, by <span class="op">=</span> <span class="st">'date'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Join with the q_plus table by date</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">q_2012</span>, by <span class="op">=</span> <span class="st">'date'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Join with the q_plus table by date</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">.</span>, cols <span class="op">=</span> <span class="op">-</span><span class="va">date</span>, names_to <span class="op">=</span> <span class="st">'variable'</span>, values_to <span class="op">=</span> <span class="st">'discharge'</span><span class="op">)</span> <span class="co"># Make a long table for plotting</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">q_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">discharge</span>, col <span class="op">=</span> <span class="va">variable</span>, lty <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tomato3'</span>, <span class="st">'black'</span>, <span class="st">'steelblue3'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dotted'</span>, <span class="st">'solid'</span>, <span class="st">'dashed'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="changing-parameter-values">Changing parameter values<a class="anchor" aria-label="anchor" href="#changing-parameter-values"></a>
</h2>
<p>Changing parameter values is an essential option for SWAT model simulations. In a SWAT model calibration we (or at least I do) define large sets of combinations for model parameter changes and apply each of them in model simulations. Parameter optimization usually starts with an initial parameter combination and iteratively tests new parameter combinations to progessively improve the model performance. <code>SWATplusR</code>’s <code>run_swat*()</code> functions can easily be included in such modelling workflows in <code>R</code>. Parameter value changes in a SWAT run are controlled through the input argument <code>parameter</code>.</p>
<div class="section level3">
<h3 id="parameter-inputs">
<code>parameter</code> inputs<a class="anchor" aria-label="anchor" href="#parameter-inputs"></a>
</h3>
<p>The input argument <code>parameter</code> is available in <code>run_swatplus</code> and <code>run_swat2012</code>. The definition of parameter changes works in a very similar way for SWAT+ and SWAT2012 models. The definition of a parameter value change essentially consists of a parameter name text string and a value that defines the magnitude of the change. The name definition for a parameter value change follows a very specific syntax. The individual parts of that text string control different aspects of a parameter change. The overview figure below shows the individual parts of a parameter name.</p>
<p><img src="figures/parchg_naming.svg" title="Parts of parameter names" alt="Parts of parameter names" width="80%" style="display: block; margin: auto;"></p>
<p>The minimum required inputs to define a parameter change are the SWAT model parameter, the type of change that should be applied to the parameter and the value of the change. The example below would cause a change of all Curve Number 2 <em>‘cn2’</em> values in a SWAT+ model setup by a value of 5.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_chg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cn2.hru|change = abschg"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>As the syntax is outlined in the figure above, the model parameter information must provide the exact name of the parameter in the model together with the file suffix (or in case of SWAT+ the unit) where this parameter is implemented. The parameter name and the suffix are separated by a <code>'.'</code>. <em>‘cn2’</em> is an HRU parameter in a SWAT+ setup. Therefore the suffix is <code>'.hru'</code>. All expressions that follow the parameter are separated by a pipe dash <code>'|'</code>. As a second expression the type of change must follow. The type definition is always written as <code>'change = change_type'</code>. Four types of parameter changes can be applied. <code>'absval'</code> replaces the initial value by the newly defined value. <code>'abschg'</code> adds an absolute value to the initial parameter value. <code>'relchg'</code> and <code>'pctchg'</code> change a parameter by a fraction or a percentage of the initial parameter value.</p>
<p>Similar to the ouput definition the goal for the parameter definition was to keep the syntax for SWAT+ and SWAT2012 the same. Yet again differences are present due to , e.g. different parameter names in the model and parameter suffixes. The parameter change from the example above would look as follows for a SWAT2012 model setup. We see that the parameter name is written all caps, as the Curve Number 2 is defined this way in the SWAT2012 input files. Also the parameter is not defined in the <em>‘.hru’</em> input files, but is part of the <em>‘.mgt’</em> input files.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_chg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CN2.mgt|change = abschg"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>The parameters, their associated object types and value ranges of SWAT+ model setups are listed in the <em>‘cal_parms.cal’</em> that should be available in every SWAT+ <em>‘TxtInOut’</em> folder. <strong><em>Caution:</em></strong> <em>There is no guarantee that changes for all of the parameters that are listed in this file are effective. I always recommend to test parameter changes in small examples.</em> To identify SWAT2012 parameters and their associated input files I recommend to look into your SWAT2012 peoject and check where the parameters can be found.</p>
<p>You can define individual names for a parameter. This is in most cases optional. The name must be unique and cannot be used for other parameters. If no name is assigned the SWAT parameter name is used instead. Thus, a common situation when you have to define a parameter name, is when you define a change of the same parameter e.g. for different subbasins, soils, slope classes, etc. (which are defined by parameter conditions which are explained below and with more detail in an upcoming article on parameter definition). If a parameter name is assigned the parameter name has to be in the first position and is separated by <code>'::'</code> from the following expressions. The example below shows a case where the SWAT2012 model parameter <em>‘CANMX’</em> is used twice but changed to different values for different land uses.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_chg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"canmax_forest::CANMX.hru | change = absval | luse %in% c('FRST', 'FRSD', 'FRSE')"</span> <span class="op">=</span> <span class="fl">4</span>,
             <span class="st">"canmax_other::CANMX.hru | change = absval | !(luse %in% c('FRST', 'FRSD', 'FRSE'))"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>In the example the initial values of the SWAT2012 parameter <em>‘CANMX’</em> are replaced by different values for forest land uses and all other land uses. Therefore, individual names are required that you have to assign. Otherwise, <code>run_swat*()</code> tries to assign the same name to effectively two different parameter changes and would trigger an error.</p>
<p>The last expression that you can see in both parameter definitions in the example above are called conditions. With conditions you can constrain a parameter change to specific units of your model setup and thus the parameter change does not affect the entire model setup. The conditions must be written as <code>R</code> code syntax. The first condition above <code>'luse %in% c('FRST', 'FRSD', 'FRSE')'</code> means that the parameter <em>‘CANMX’</em> receives a value of 4 in every HRU where the land use is a forest land use. The second expression <code>'!(luse %in% c('FRST', 'FRSD', 'FRSE'))'</code> means the opposite, so all land uses that are no forest land use.</p>
<p>The syntax for conditions is again similar for SWAT+ and SWAT2012 model setups. Yet, major differences exist in the variables that can be used to apply a condition. The biggest difference is present for the definition of spatial units. While SWAT2012 model setups have a very clear overall model structure, SWAT+ setups can be very flexible in their spatial configuration. Due to the clear structure of SWAT2012 models the spatial conditions <code>'sub'</code> or <code>'hru'</code> can be applied to all parameters. For SWAT+ conditions only the spatial variable <code>'unit'</code> exists which can be used to constrain a change to unit IDs of objects to which a parameter is associated to.</p>
<p>The example below defines parameter value changes for a SWAT2012 model setup. The parameter <em>‘ALPHA_BF’</em> is changed by three different values depending on the Subbasin ID. Again in this case the definition of unique parameter names is mandatory. The parameter <em>‘USLE_P’</em> is only changed in three specific HRUs. It is not required to assign a parameter name here, but it is overall good practice to give the parameter changes good, self explanatory names that help in any further analysis.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_cond2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a_bf_head::ALPHA_BF.gw | change = abschg | sub &lt; 4"</span> <span class="op">=</span> <span class="fl">0.2</span>,
                  <span class="st">"a_bf_upland::ALPHA_BF.gw | change = abschg | sub %in% c(5,7,11)"</span> <span class="op">=</span> <span class="fl">0.35</span>,
                  <span class="st">"a_bf_floodpl::ALPHA_BF.gw | change = abschg | sub %in% c(6,8:10)"</span> <span class="op">=</span> <span class="fl">0.6</span>,
                  <span class="st">"p_terrace::USLE_P.mgt | change = absval | hru %in% c(37, 45, 154)"</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p>The example below shows unit conditions for SWAT+ model parameters. While the changes for <em>‘cn2’</em> affect specific HRUs that were defined with the <code>'unit'</code> condition, the unit condition in the second case addresses the aquifers with the IDs 1 and 5 as the parameter <em>‘alpha’</em> is an aquifer parameter.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_condplus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cn2_agri::cn2.hru | change = relchg | unit = c(1:12, 25:27, 46:72)"</span> <span class="op">=</span> <span class="op">-</span> <span class="fl">0.05</span>,
                  <span class="st">"alpha::alpha.aqu | change = absval | unit %in% c(1,5)"</span> <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span></code></pre></div>
<p>There are many possibilities to define conditions for parameter changes and multiple variables exist that can be used in conditions. These will be further addressed in an article on parameter changes that also provides overview tables for condition variables and gives further examples for parameter definitions. <em>(This article is currently in preparation)</em>.</p>
</div>
<div class="section level3">
<h3 id="simulation-with-one-parameter-combination">Simulation with one parameter combination<a class="anchor" aria-label="anchor" href="#simulation-with-one-parameter-combination"></a>
</h3>
<p>You can define one combination of parameter changes with a named vector. Each parameter combination is defined as described in the examples above, which is a parameter name following the specific syntax and the value of the change. The parameter changes are concatinated with the concatinate <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function to form the parameter combination. To define single parameter set a named vector is generated. The names define the parameters the type of change. Below we generate a combination of parameter changes for 9 SWAT+ model parameters that are frequently used in model calibration.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cn2.hru | change = abschg | plant == 'corn'"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,
              <span class="st">'lat_ttime.hru | change = absval'</span> <span class="op">=</span> <span class="fl">0.5</span>,
              <span class="st">'lat_len.hru | change = abschg'</span> <span class="op">=</span> <span class="fl">30</span>,
              <span class="st">'epco.hru | change = absval'</span> <span class="op">=</span> <span class="fl">0.8</span>,
              <span class="st">'esco.hru | change = absval'</span> <span class="op">=</span> <span class="fl">0.5</span>,
              <span class="st">'perco.hru | change = absval'</span> <span class="op">=</span> <span class="fl">0.4</span>,
              <span class="st">"k.sol | change = pctchg | hsg == 'C'"</span> <span class="op">=</span> <span class="fl">25</span>,
              <span class="st">'awc.sol | change = pctchg'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,
              <span class="st">'alpha.aqu | change = absval'</span> <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span></code></pre></div>
<p>The generated parameter combination can be included in the SWAT+ model execution by passing the parameter set to the input argument <code>parameter</code> in the <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> function call. So you see that the only difference between a simulation where no parameter changes are applied and the simulation run below is the input argument <code>parameter</code>, that is not <code>NULL</code> but uses the defined vector <code>par_comb</code> to define the parameter changes.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                       output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"channel_sd"</span>,
                                              variable <span class="op">=</span> <span class="st">"flo_out"</span>,
                                              unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                       parameter <span class="op">=</span> <span class="va">par_comb</span><span class="op">)</span>

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 1S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 1S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 2S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-results-with-one-parameter-combination">Exploring results with one parameter combination<a class="anchor" aria-label="anchor" href="#exploring-results-with-one-parameter-combination"></a>
</h3>
<p>To recap, the simulation where no parameter changes were applied returned a single <code>tibble</code> with the simulation outputs for the defined output variables. The output <code>q_sim1</code> in this example is a bit more complex and consists of a <code>list</code> of <code>tibbles</code> as we have to store more information in the case of changed parameter values. The output consists of two main parts.</p>
<p>The first element is <code>parameter</code> which is again a list that hast two <code>tibble</code> elements. The first one is <code>parameter$values</code> that stores all parameter combinations in a <code>tibble</code>, in this case with nine columns for all the parameters and one row, as we only defined one parameter combination. The names of the parameter are in this case the SWAT+ model parameter names as we did not define individual names. If individual parameter names were defined the column names would be the individual names.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim1</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 9</span></span>
<span class="co">#&gt;     cn2 lat_ttime lat_len  epco  esco perco     k   awc alpha</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    -<span style="color: #BB0000;">5</span>       0.5      30   0.8   0.5   0.4    25   -<span style="color: #BB0000;">10</span>  0.35</span></code></pre></div>
<p>The second element is <code>parameter$definition</code>. This is a tibble that provides the information how we defined each parameter change. The value of a parameter change alone is useless information as it does not say anything about the type of change or any parameter conditions that were applied. The definition table again shows the <code>par_name</code> which is the user defined name in case a name was assigned. In this example <code>par_name</code> is the same as <code>parameter</code> which is the SWAT parameter name. The column <code>file_name</code> indicates the file or unit level where the parameter is implemented and is the suffix of <code>parameter</code> that we defined for <code>par_comb</code>. <code>change</code> showes the type of change that was applied to a parameter. If parameter conditions were implemented in the parameter set additional columns are visible in the table that give information of the applied rules. In this example changes for <em>‘cn2’</em> were only employed when corn is currently planted in an HRU and the hydraulic conductivity <em>‘k’</em> was increased for soils of the hydrological soil group ‘C.’ The last column <code>full_name</code> gives the full parameter combination as it was defined above.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim1</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">definition</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 x 7</span></span>
<span class="co">#&gt;   par_name  parameter file_name change plant    hsg   full_name                 </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> cn2       cn2       hru       abschg =='corn' <span style="color: #BB0000;">NA</span>    cn2.hru | change = abschg~</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lat_ttime lat_ttime hru       absval <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    lat_ttime.hru | change = ~</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lat_len   lat_len   hru       abschg <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    lat_len.hru | change = ab~</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> epco      epco      hru       absval <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    epco.hru | change = absval</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> esco      esco      hru       absval <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    esco.hru | change = absval</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> perco     perco     hru       absval <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    perco.hru | change = absv~</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span> k         k         sol       pctchg <span style="color: #BB0000;">NA</span>       =='C' k.sol | change = pctchg |~</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span> awc       awc       sol       pctchg <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    awc.sol | change = pctchg </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">9</span> alpha     alpha     aqu       absval <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>    alpha.aqu | change = absv~</span></code></pre></div>
<p>The second part of the simulation outputs provides the <code>simulation</code> results for the defined output variables in a <code>tibble</code>. The structure of this table is the same as the one of the outputs where no parameter changes were implemented. If the parameter changes should have an effect on the simulation of <code>flo_out</code>, the simulated values simulated values stored in <code>simulation</code> should of course be different.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_sim1</span><span class="op">$</span><span class="va">simulation</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 2</span></span>
<span class="co">#&gt;    date       flo_out</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.001<span style="text-decoration: underline;">85</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span></code></pre></div>
<p>To see if the parameter change was effective we compare the simulated outputs of <code>q_sim1</code> where we implemented the parameter set <code>par_comb</code> to the initial simulation <code>q_sim_plus</code> from our <a href="https://chrisschuerz.github.io/SWATplusR/articles/SWATplusR.html#first-swat-model-runs" class="external-link">first SWAT model runs</a> in a simple plot.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="co"># Adding a column that indicates the par change to q_sim1</span>
<span class="va">q_sim1_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">q_sim1</span><span class="op">$</span><span class="va">simulation</span>, par_change <span class="op">=</span> <span class="st">'yes'</span><span class="op">)</span> 

<span class="co"># Preparing the plot table</span>
<span class="va">q_plot</span> <span class="op">&lt;-</span> <span class="va">q_sim_plus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.</span>, par_change <span class="op">=</span> <span class="st">'no'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Also add par change column to q_sim_plus</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">q_sim1_sim</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">q_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">flo_out</span>, col <span class="op">=</span> <span class="va">par_change</span>, linetype <span class="op">=</span> <span class="va">par_change</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tomato3'</span>, <span class="st">'steelblue3'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'solid'</span>, <span class="st">'dashed'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>The plot shows differences between the two simulations, particularly for the recession and base flow of the discharge. Without discussing the results in any way, we can see that the parameter changes were effective in our small example. I would strongly recommend to perform such a procedure with short simulation runs and every parameter that should be included in e.g. a calibration individually to verify that intended parameter changes actually work. It is better to invest some time in a few quick simulation experiments, than having to realize that changing parameter values did not work after running thousands of simulations for a few days.</p>
</div>
<div class="section level3">
<h3 id="simulations-with-a-parameter-set">Simulations with a parameter set<a class="anchor" aria-label="anchor" href="#simulations-with-a-parameter-set"></a>
</h3>
<p>Similar to the single parameter combination in the previous example we can also define entire parameter sets that we implement in the simulation runs. The only difference is that we cannot define a set of parameter combinations with a single vector with the <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function. Instead we define a <code>tibble</code> with our parameter combinations. In this tibble each column defines a parameter change (again through the syntax of its name). Each row is one combination of the parameter changes that will be used in a simulation. The example below uses a similar combination of parameter changes as in the previous example. This time we uniformly sample each parameter change <code>n = 5</code> times with <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif()</a></code> and combine all samples to a table with 9 columns and 5 rows.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>

<span class="va">par_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">'cn2.hru | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">15</span>,<span class="fl">10</span><span class="op">)</span>,
                  <span class="st">'lat_ttime.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.5</span>,<span class="fl">5</span><span class="op">)</span>,
                  <span class="st">'lat_len.hru | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span>,
                  <span class="st">'epco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,
                  <span class="st">'esco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,
                  <span class="st">'perco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span><span class="op">)</span>,
                  <span class="st">'k.sol | change = pctchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">100</span><span class="op">)</span>,
                  <span class="st">'awc.sol | change = pctchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>,
                  <span class="st">'alpha.aqu | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>

<span class="va">par_set</span></code></pre></div>
<p>The implementation in <code>run_swat*()</code> works the same way as with a single parameter set. The parameter table <code>par_set</code> is simply passed to the input argument <code>parameter</code>. To show the main differences in the simulation outputs we define the three SWAT output variables <em>‘flo_out’</em>, <em>‘surq_gen’</em>, and <em>‘latq’</em> to be returned in <code>R</code>. The progress message this time shows that 5 simulations are performed and updates the elapsed and remaining time for the simulations, which can be valuable information in case of longer simulation experiments. It further says that the simulations are performed on one core. Parallel processing is implemented in <code>SWATplusR</code> and can be easily activated with the input argument <code>n_thread</code>. Parallel processing will be briefly addressed in the section ??? below.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_simn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                       output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q_cha <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'channel_sd'</span>,
                                                           variable <span class="op">=</span> <span class="st">'flo_out'</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                                     q_sur <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"basin_wb"</span>,
                                                           variable <span class="op">=</span> <span class="st">"surq_gen"</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                                     q_lat <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"basin_wb"</span>,
                                                           variable <span class="op">=</span> <span class="st">"latq"</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                       parameter <span class="op">=</span> <span class="va">par_set</span><span class="op">)</span>

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 0S   Time remaining: 1S    </span>
<span class="co">#&gt;  Completed 1 thread in 1S</span>
<span class="co">#&gt; Performing 5 simulations on 1 cores:</span>
<span class="co">#&gt;  Simulation 4 of 5   Time elapsed: 16S   Time remaining: 4S</span>
<span class="co">#&gt;  Completed 5 simulations in 20S</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploring-results-with-a-parameter-set">Exploring results with a parameter set<a class="anchor" aria-label="anchor" href="#exploring-results-with-a-parameter-set"></a>
</h3>
<p>The general structure of the simulation output that results from a parameter set is a again a <code>list</code> with the two main elements <code>parameter</code> and <code>simulation</code>. If we have a look at <code>q_simn$parameter</code> we can see that the structure is the same as in the previous example. Differences are that the <code>parameter$values</code> table now has 5 rows as we used 5 different parameter combinations in our simulation runs. The table <code>parameter$definition</code> lacks the columns for the conditions <code>plant</code> and <code>hsg</code> this time as we did not define any parameter conditions this time.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_simn</span><span class="op">$</span><span class="va">parameter</span>
<span class="co">#&gt; $values</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 x 9</span></span>
<span class="co">#&gt;      cn2 lat_ttime lat_len  epco  esco perco     k    awc alpha</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">14.3</span>       2.56   38.8  0.764 0.359 0.232  5.27  -<span style="color: #BB0000;">3.70</span> 0.422</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">10.4</span>       2.65    4.81 0.941 0.432 0.760  9.15 -<span style="color: #BB0000;">14.9</span>  0.267</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">12.0</span>       1.51   41.6  0.548 0.845 0.375 79.9  -<span style="color: #BB0000;">15.5</span>  0.561</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   2.55      4.16    2.47 0.816 0.479 0.467 -<span style="color: #BB0000;">9.72</span>  17.9  0.109</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   9.62      1.64   25.7  0.191 0.140 0.790 63.2  -<span style="color: #BB0000;">14.3</span>  0.279</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $definition</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 x 5</span></span>
<span class="co">#&gt;   par_name  parameter file_name change full_name                      </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> cn2       cn2       hru       abschg cn2.hru | change = abschg      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lat_ttime lat_ttime hru       absval lat_ttime.hru | change = absval</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lat_len   lat_len   hru       abschg lat_len.hru | change = abschg  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> epco      epco      hru       absval epco.hru | change = absval     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> esco      esco      hru       absval esco.hru | change = absval     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> perco     perco     hru       absval perco.hru | change = absval    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span> k         k         sol       pctchg k.sol | change = pctchg        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span> awc       awc       sol       pctchg awc.sol | change = pctchg      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">9</span> alpha     alpha     aqu       absval alpha.aqu | change = absval</span></code></pre></div>
<p>The major difference in the output list is given in the <code>simulation</code> outputs. <code>simulation</code> is not a single table as it was the case for the simulations with a single parameter combination. In the case of multiple simulations with more than one parameter combination a <code>list</code> of <code>tibbles</code> is generated. As we can see for <code>q_simn$simulation</code> the output is organized in three tables each table provides the simulation runs for each output variable that we defined. Each table in this case has a <code>date</code> column as its first column followed by the columns <code>run_1</code> until <code>run_5</code> where each run provides the simulation outputs for each of the 5 parameter combinations.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_simn</span><span class="op">$</span><span class="va">simulation</span>
<span class="co">#&gt; $q_cha</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 6</span></span>
<span class="co">#&gt;    date         run_1   run_2   run_3   run_4   run_5</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.001<span style="text-decoration: underline;">94</span> 0.001<span style="text-decoration: underline;">87</span> 0.002<span style="text-decoration: underline;">31</span> 0.002<span style="text-decoration: underline;">94</span> 0.019<span style="text-decoration: underline;">8</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0       0       0       0       0.002<span style="text-decoration: underline;">37</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0       0       0       0       0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $q_sur</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 6</span></span>
<span class="co">#&gt;    date       run_1 run_2 run_3 run_4 run_5</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01     0     0     0 0.003 0.069</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02     0     0     0 0     0.011</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03     0     0     0 0     0.002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10     0     0     0 0     0    </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $q_lat</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,653 x 6</span></span>
<span class="co">#&gt;    date       run_1 run_2 run_3 run_4 run_5</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.004 0.004 0.006 0.005 0.005</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0.004 0.003 0.005 0.005 0.004</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0.004 0.003 0.004 0.005 0.003</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0.004 0.003 0.004 0.005 0.003</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0.004 0.002 0.003 0.005 0.003</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0.003 0.002 0.003 0.005 0.002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0.003 0.002 0.003 0.005 0.002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0.003 0.002 0.003 0.005 0.002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0.003 0.002 0.003 0.004 0.002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0.003 0.002 0.003 0.004 0.002</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 3,643 more rows</span></span></code></pre></div>
<p>Again we visualize the simulation results for the 5 parameter combinations. For simplicity we again only use the outputs of <em>‘flo_out’</em>. To better see any differences between the runs we also only plot the year 2008. Without going into any details, we see that substantial differences in the runoff peaks, recession and base flow is visible. The plot example illustrates that the data structure of the simulation outputs makes it easy to process the SWAT simulations in any further analyses.</p>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="setting-simulation-period-and-interval">Setting simulation period and interval<a class="anchor" aria-label="anchor" href="#setting-simulation-period-and-interval"></a>
</h2>
<p>Defining the simulation periods and the time intervals in which the simulation results are printed are necessary settings in nearly every SWAT simulation. <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> provide some input arguments to define these arguments for SWAT simulations. Most of the input arguments are the same for SWAT+ and SWAT2012 simulations and only a few difference must be considered.</p>
<p>You can control the simulation period with the two input arguments <code>start_date</code> and <code>end_date</code> in <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code>. To skip a certain number of simulations before printing outputs is an additional argument that is usually defined together with the time frame for the simulation. The reason to skip a few years of the the simulated time series that should not be printed is to use these simulated years as a warm up period to initiate state variables in the SWAT model run. <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> provide the input argument <code>years_skip</code> to define the number of years that are not printed in the outputs. In the example below we define that simulations should be performed between 2000-01-01 and 2005-12-31 where the first 3 years are skipped for output printing.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_set_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                             output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span><span class="st">'channel_sd'</span>, <span class="st">'flo_out'</span>, <span class="fl">1</span><span class="op">)</span>,
                             start_date <span class="op">=</span> <span class="fl">20000101</span>,
                             end_date <span class="op">=</span> <span class="fl">20051231</span>,
                             years_skip <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run': </span>
<span class="co">#&gt;  Completed 1 thread in 0S                                                   </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
<p>When we have a look at the simulated time series we can see that it starts in the year 2003 and holds data for 3 years.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_set_date</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,096 x 2</span></span>
<span class="co">#&gt;    date       flo_out</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.004<span style="text-decoration: underline;">12</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 1,086 more rows</span></span></code></pre></div>
<p><code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> provides an additional input argument to define the date when output printing should be started. With <code>start_date_print</code> you can define a date for which the first outputs should be printed rather than defining the years that should be skipped. This can be an advantage in some cases, but might be synonymous to <code>years_skip</code> in many other cases. A situation where <code>start_date_print</code> can be favored is when hydrological years should be simulated rather than calendar years. <code>years_skip</code>would in such cases simply skip the defined years and starts printing at the first of January of the next year. With <code>start_date_print</code> printing of outputs can e.g. be started at October first if this is the start day of the hydrological year. The example below shows the described difference between <code>years_skip</code> and <code>start_date_print</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_yskip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                          output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span><span class="st">'channel_sd'</span>, <span class="st">'flo_out'</span>, <span class="fl">1</span><span class="op">)</span>,
                          start_date <span class="op">=</span> <span class="fl">20001101</span>,
                          end_date <span class="op">=</span> <span class="fl">20051031</span>,
                          years_skip <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run': </span>
<span class="co">#&gt;  Completed 1 thread in 0S                                                   </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_stprint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                            output <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span><span class="st">'channel_sd'</span>, <span class="st">'flo_out'</span>, <span class="fl">1</span><span class="op">)</span>,
                            start_date <span class="op">=</span> <span class="fl">20001101</span>,
                            end_date <span class="op">=</span> <span class="fl">20051031</span>,
                            start_date_print <span class="op">=</span> <span class="fl">20031101</span><span class="op">)</span>
<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run': </span>
<span class="co">#&gt;  Completed 1 thread in 0S                                                   </span>
<span class="co">#&gt; Performing 1 simulation on 1 core: </span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_yskip</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,035 x 2</span></span>
<span class="co">#&gt;    date       flo_out</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-01-01 0.004<span style="text-decoration: underline;">14</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-01-02 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-01-03 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-01-04 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-01-05 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-01-06 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-01-07 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-01-08 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-01-09 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-01-10 0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 1,025 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_stprint</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 731 x 2</span></span>
<span class="co">#&gt;    date       flo_out</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2003-11-01 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2003-11-02 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2003-11-03 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2003-11-04 0.001<span style="text-decoration: underline;">58</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2003-11-05 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2003-11-06 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2003-11-07 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2003-11-08 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2003-11-09 0      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2003-11-10 0      </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 721 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parallel-processing-with-n_thread">Parallel processing with <code>n_thread</code><a class="anchor" aria-label="anchor" href="#parallel-processing-with-n_thread"></a>
</h2>
<p><code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> and <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> provide the option to employ parallel processing to perform SWAT simulations in parallel on multiple cores when several parameter sets should be used in simulations with a SWAT setup. We will use the example from above, but define 16 parameter combinations this time.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">16</span>

<span class="va">par_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">'cn2.hru | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">15</span>,<span class="fl">10</span><span class="op">)</span>,
                  <span class="st">'lat_ttime.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.5</span>,<span class="fl">5</span><span class="op">)</span>,
                  <span class="st">'lat_len.hru | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span>,
                  <span class="st">'epco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,
                  <span class="st">'esco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,
                  <span class="st">'perco.hru | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span><span class="op">)</span>,
                  <span class="st">'k.sol | change = pctchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">100</span><span class="op">)</span>,
                  <span class="st">'awc.sol | change = pctchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="op">-</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>,
                  <span class="st">'alpha.aqu | change = absval'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0.1</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>

<span class="va">par_set</span></code></pre></div>
<p>The only difference when performing the simulations now is that we define <code>n_thread = 4</code>. This means that we use 4 cores of the computer and always run 4 different parameter combinations in parallel. We can see that the run time per parameter combination was reduced. How large the reduction is depends on many parameters and is not always a one-to-one reduction (i.e. doubling the number of cores does not necessarily halve the run time).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_simn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_swatplus.html">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">path_plus</span>,
                       output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q_cha <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'channel_sd'</span>,
                                                           variable <span class="op">=</span> <span class="st">'flo_out'</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                                     q_sur <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"basin_wb"</span>,
                                                           variable <span class="op">=</span> <span class="st">"surq_gen"</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
                                     q_lat <span class="op">=</span> <span class="fu"><a href="../reference/define_output.html">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"basin_wb"</span>,
                                                           variable <span class="op">=</span> <span class="st">"latq"</span>,
                                                           unit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                       parameter <span class="op">=</span> <span class="va">par_set</span>,
                       n_thread <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 0S   Time remaining: 1S    </span>
<span class="co">#&gt;  Completed 4 thread in 1S</span>
<span class="co">#&gt; Performing 16 simulations on 4 cores:</span>
<span class="co">#&gt;  Simulation 8 of 16   Time elapsed: 22S   Time remaining: 20S</span>
<span class="co">#&gt;  Completed 16 simulations in 40S</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-Bosch2007" class="csl-entry">
Bosch, D. D., Sheridan, J. M., Lowrance, R. R., Hubbard, R. K., Strickland, T. C., Feyereisen, G. W. and Sullivan, D. G.: Little river experimental watershed database, Water Resources Research, 43(9), doi:<a href="https://doi.org/10.1029/2006wr005844" class="external-link">10.1029/2006wr005844</a>, 2007.
</div>
<div id="ref-Mueller2019" class="csl-entry">
Müller, K. and Wickham, H.: Tibble: Simple data frames. [online] Available from: <a href="https://CRAN.R-project.org/package=tibble" class="external-link">https://CRAN.R-project.org/package=tibble</a> (Accessed 5 March 2019), 2019.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christoph Schuerz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
